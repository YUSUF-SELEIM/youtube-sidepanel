import"../../style.js";const u=document.getElementById("no-video"),a=document.getElementById("video-info"),l=document.getElementById("video-title"),s=document.getElementById("open-sidepanel");function t(e){console.log(`[YouTube SideView Popup] ${e}`)}async function m(){t("Opening side panel");try{const e=await chrome.tabs.query({active:!0,currentWindow:!0});if(e.length>0){const n=e[0];t(`Active tab ID: ${n.id}`),n.url.includes("youtube.com/watch")&&chrome.scripting.executeScript({target:{tabId:n.id},function:()=>{const o=document.querySelector("video");return o?(console.log("[YouTube SideView] Pausing original video"),o.pause(),{currentTime:o.currentTime}):{currentTime:0}}}).then(o=>{var d,c;const i=((c=(d=o[0])==null?void 0:d.result)==null?void 0:c.currentTime)||0;t(`Current video time: ${i}`),chrome.storage.local.get(["currentVideo"],r=>{r.currentVideo&&chrome.storage.local.set({currentVideo:{...r.currentVideo,timestamp:i}})})}).catch(o=>{t(`Error executing script: ${o}`)}),await chrome.sidePanel.open({tabId:n.id}),t("Side panel opened successfully"),window.close()}else t("No active tab found")}catch(e){t(`Error opening side panel: ${e}`)}}function g(){chrome.storage.local.get(["currentVideo"],e=>{t(`Video info from storage: ${JSON.stringify(e)}`),e.currentVideo&&e.currentVideo.videoId?(t(`Found video: ${e.currentVideo.title}`),u.classList.add("hidden"),a.classList.remove("hidden"),l.textContent=e.currentVideo.title,l.title=e.currentVideo.title):(t("No active video found"),u.classList.remove("hidden"),a.classList.add("hidden"))})}document.addEventListener("DOMContentLoaded",()=>{t("Popup loaded"),g(),s.addEventListener("click",()=>{t("Side panel button clicked"),m()})});
