import"../../style.js";const c=document.getElementById("no-video"),l=document.getElementById("video-player"),m=document.getElementById("youtube-iframe");let i=null,a=null;function e(d){console.log(`[YouTube SideView SidePanel] ${d}`)}function s(d=!1){e("Checking for video info updates"),chrome.storage.local.get(["currentVideo"],o=>{if(o.currentVideo&&o.currentVideo.videoId){const n=o.currentVideo.videoId,t=Math.floor(o.currentVideo.timestamp||0),u=i!==n,f=Math.abs(t-(a||0))>10;if(u||d||f){e(`Loading video at timestamp ${t}s`),c.classList.add("hidden"),l.classList.remove("hidden");const r=`https://www.youtube.com/embed/${n}?autoplay=1&start=${t}`;e(`Setting iframe src to: ${r}`),m.src=r,i=n,a=t}else e("Video already loaded, no need to refresh")}else e("No video information found"),c.classList.remove("hidden"),l.classList.add("hidden"),m.src="",i=null,a=null})}document.addEventListener("DOMContentLoaded",()=>{e("Side panel loaded"),s(!0),chrome.storage.onChanged.addListener((d,o)=>{o==="local"&&d.currentVideo&&(e("Video info changed in storage"),s())})});setInterval(()=>s(),3e4);
